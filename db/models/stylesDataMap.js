var mockData = [
  {
    "id": 139,
    "name": "White",
    "sale_price": "null",
    "original_price": "782",
    "default_style": "1",
    "sid": 919,
    "size": "XS",
    "quantity": "35",
    "url": "https://images.unsplash.com/photo-1525896650794-60ad4ec40d0e?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1650&q=80",
    "thumbnail_url": "https://images.unsplash.com/photo-1561861422-a549073e547a?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=300&q=80"
  },
  {
    "id": 139,
    "name": "White",
    "sale_price": "null",
    "original_price": "782",
    "default_style": "1",
    "sid": 919,
    "size": "XS",
    "quantity": "35",
    "url": "https://images.unsplash.com/photo-1541006008768-d181e7f9f3d9?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1568&q=80",
    "thumbnail_url": "https://images.unsplash.com/photo-1557804506-669a67965ba0?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=300&q=80"
  },
  {
    "id": 139,
    "name": "White",
    "sale_price": "null",
    "original_price": "782",
    "default_style": "1",
    "sid": 919,
    "size": "XS",
    "quantity": "35",
    "url": "https://images.unsplash.com/photo-1454024183771-42d54053cd75?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1650&q=80",
    "thumbnail_url": "https://images.unsplash.com/photo-1519862170344-6cd5e49cb996?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=300&q=80"
  },
  {
    "id": 139,
    "name": "White",
    "sale_price": "null",
    "original_price": "782",
    "default_style": "1",
    "sid": 919,
    "size": "XS",
    "quantity": "35",
    "url": "https://images.unsplash.com/photo-1544376664-80b17f09d399?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1525&q=80",
    "thumbnail_url": "https://images.unsplash.com/photo-1553830591-2f39e38a013c?ixlib=rb-1.2.1&auto=format&fit=crop&w=300&q=80"
  },
  {
    "id": 139,
    "name": "White",
    "sale_price": "null",
    "original_price": "782",
    "default_style": "1",
    "sid": 920,
    "size": "S",
    "quantity": "43",
    "url": "https://images.unsplash.com/photo-1525896650794-60ad4ec40d0e?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1650&q=80",
    "thumbnail_url": "https://images.unsplash.com/photo-1561861422-a549073e547a?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=300&q=80"
  },
  {
    "id": 139,
    "name": "White",
    "sale_price": "null",
    "original_price": "782",
    "default_style": "1",
    "sid": 920,
    "size": "S",
    "quantity": "43",
    "url": "https://images.unsplash.com/photo-1541006008768-d181e7f9f3d9?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1568&q=80",
    "thumbnail_url": "https://images.unsplash.com/photo-1557804506-669a67965ba0?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=300&q=80"
  },
  {
    "id": 139,
    "name": "White",
    "sale_price": "null",
    "original_price": "782",
    "default_style": "1",
    "sid": 920,
    "size": "S",
    "quantity": "43",
    "url": "https://images.unsplash.com/photo-1454024183771-42d54053cd75?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1650&q=80",
    "thumbnail_url": "https://images.unsplash.com/photo-1519862170344-6cd5e49cb996?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=300&q=80"
  },
  {
    "id": 139,
    "name": "White",
    "sale_price": "null",
    "original_price": "782",
    "default_style": "1",
    "sid": 920,
    "size": "S",
    "quantity": "43",
    "url": "https://images.unsplash.com/photo-1544376664-80b17f09d399?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1525&q=80",
    "thumbnail_url": "https://images.unsplash.com/photo-1553830591-2f39e38a013c?ixlib=rb-1.2.1&auto=format&fit=crop&w=300&q=80"
  },
  {
    "id": 139,
    "name": "White",
    "sale_price": "null",
    "original_price": "782",
    "default_style": "1",
    "sid": 921,
    "size": "M",
    "quantity": "14",
    "url": "https://images.unsplash.com/photo-1525896650794-60ad4ec40d0e?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1650&q=80",
    "thumbnail_url": "https://images.unsplash.com/photo-1561861422-a549073e547a?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=300&q=80"
  },
  {
    "id": 139,
    "name": "White",
    "sale_price": "null",
    "original_price": "782",
    "default_style": "1",
    "sid": 921,
    "size": "M",
    "quantity": "14",
    "url": "https://images.unsplash.com/photo-1541006008768-d181e7f9f3d9?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1568&q=80",
    "thumbnail_url": "https://images.unsplash.com/photo-1557804506-669a67965ba0?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=300&q=80"
  },
  {
    "id": 139,
    "name": "White",
    "sale_price": "null",
    "original_price": "782",
    "default_style": "1",
    "sid": 921,
    "size": "M",
    "quantity": "14",
    "url": "https://images.unsplash.com/photo-1454024183771-42d54053cd75?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1650&q=80",
    "thumbnail_url": "https://images.unsplash.com/photo-1519862170344-6cd5e49cb996?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=300&q=80"
  },
  {
    "id": 139,
    "name": "White",
    "sale_price": "null",
    "original_price": "782",
    "default_style": "1",
    "sid": 921,
    "size": "M",
    "quantity": "14",
    "url": "https://images.unsplash.com/photo-1544376664-80b17f09d399?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1525&q=80",
    "thumbnail_url": "https://images.unsplash.com/photo-1553830591-2f39e38a013c?ixlib=rb-1.2.1&auto=format&fit=crop&w=300&q=80"
  },
  {
    "id": 139,
    "name": "White",
    "sale_price": "null",
    "original_price": "782",
    "default_style": "1",
    "sid": 922,
    "size": "L",
    "quantity": "15",
    "url": "https://images.unsplash.com/photo-1525896650794-60ad4ec40d0e?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1650&q=80",
    "thumbnail_url": "https://images.unsplash.com/photo-1561861422-a549073e547a?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=300&q=80"
  },
  {
    "id": 139,
    "name": "White",
    "sale_price": "null",
    "original_price": "782",
    "default_style": "1",
    "sid": 922,
    "size": "L",
    "quantity": "15",
    "url": "https://images.unsplash.com/photo-1541006008768-d181e7f9f3d9?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1568&q=80",
    "thumbnail_url": "https://images.unsplash.com/photo-1557804506-669a67965ba0?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=300&q=80"
  },
  {
    "id": 139,
    "name": "White",
    "sale_price": "null",
    "original_price": "782",
    "default_style": "1",
    "sid": 922,
    "size": "L",
    "quantity": "15",
    "url": "https://images.unsplash.com/photo-1454024183771-42d54053cd75?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1650&q=80",
    "thumbnail_url": "https://images.unsplash.com/photo-1519862170344-6cd5e49cb996?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=300&q=80"
  },
  {
    "id": 139,
    "name": "White",
    "sale_price": "null",
    "original_price": "782",
    "default_style": "1",
    "sid": 922,
    "size": "L",
    "quantity": "15",
    "url": "https://images.unsplash.com/photo-1544376664-80b17f09d399?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1525&q=80",
    "thumbnail_url": "https://images.unsplash.com/photo-1553830591-2f39e38a013c?ixlib=rb-1.2.1&auto=format&fit=crop&w=300&q=80"
  },
  {
    "id": 139,
    "name": "White",
    "sale_price": "null",
    "original_price": "782",
    "default_style": "1",
    "sid": 923,
    "size": "XL",
    "quantity": "22",
    "url": "https://images.unsplash.com/photo-1525896650794-60ad4ec40d0e?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1650&q=80",
    "thumbnail_url": "https://images.unsplash.com/photo-1561861422-a549073e547a?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=300&q=80"
  },
  {
    "id": 139,
    "name": "White",
    "sale_price": "null",
    "original_price": "782",
    "default_style": "1",
    "sid": 923,
    "size": "XL",
    "quantity": "22",
    "url": "https://images.unsplash.com/photo-1541006008768-d181e7f9f3d9?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1568&q=80",
    "thumbnail_url": "https://images.unsplash.com/photo-1557804506-669a67965ba0?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=300&q=80"
  },
  {
    "id": 139,
    "name": "White",
    "sale_price": "null",
    "original_price": "782",
    "default_style": "1",
    "sid": 923,
    "size": "XL",
    "quantity": "22",
    "url": "https://images.unsplash.com/photo-1454024183771-42d54053cd75?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1650&q=80",
    "thumbnail_url": "https://images.unsplash.com/photo-1519862170344-6cd5e49cb996?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=300&q=80"
  },
  {
    "id": 139,
    "name": "White",
    "sale_price": "null",
    "original_price": "782",
    "default_style": "1",
    "sid": 923,
    "size": "XL",
    "quantity": "22",
    "url": "https://images.unsplash.com/photo-1544376664-80b17f09d399?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1525&q=80",
    "thumbnail_url": "https://images.unsplash.com/photo-1553830591-2f39e38a013c?ixlib=rb-1.2.1&auto=format&fit=crop&w=300&q=80"
  },
  {
    "id": 139,
    "name": "White",
    "sale_price": "null",
    "original_price": "782",
    "default_style": "1",
    "sid": 924,
    "size": "XXL",
    "quantity": "34",
    "url": "https://images.unsplash.com/photo-1525896650794-60ad4ec40d0e?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1650&q=80",
    "thumbnail_url": "https://images.unsplash.com/photo-1561861422-a549073e547a?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=300&q=80"
  },
  {
    "id": 139,
    "name": "White",
    "sale_price": "null",
    "original_price": "782",
    "default_style": "1",
    "sid": 924,
    "size": "XXL",
    "quantity": "34",
    "url": "https://images.unsplash.com/photo-1541006008768-d181e7f9f3d9?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1568&q=80",
    "thumbnail_url": "https://images.unsplash.com/photo-1557804506-669a67965ba0?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=300&q=80"
  },
  {
    "id": 139,
    "name": "White",
    "sale_price": "null",
    "original_price": "782",
    "default_style": "1",
    "sid": 924,
    "size": "XXL",
    "quantity": "34",
    "url": "https://images.unsplash.com/photo-1454024183771-42d54053cd75?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1650&q=80",
    "thumbnail_url": "https://images.unsplash.com/photo-1519862170344-6cd5e49cb996?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=300&q=80"
  },
  {
    "id": 139,
    "name": "White",
    "sale_price": "null",
    "original_price": "782",
    "default_style": "1",
    "sid": 924,
    "size": "XXL",
    "quantity": "34",
    "url": "https://images.unsplash.com/photo-1544376664-80b17f09d399?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1525&q=80",
    "thumbnail_url": "https://images.unsplash.com/photo-1553830591-2f39e38a013c?ixlib=rb-1.2.1&auto=format&fit=crop&w=300&q=80"
  },
  {
    "id": 140,
    "name": "Azure",
    "sale_price": "null",
    "original_price": "782",
    "default_style": "0",
    "sid": 925,
    "size": "XS",
    "quantity": "21",
    "url": "https://images.unsplash.com/photo-1525896650794-60ad4ec40d0e?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1650&q=80",
    "thumbnail_url": "https://images.unsplash.com/photo-1561861422-a549073e547a?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=300&q=80"
  },
  {
    "id": 140,
    "name": "Azure",
    "sale_price": "null",
    "original_price": "782",
    "default_style": "0",
    "sid": 925,
    "size": "XS",
    "quantity": "21",
    "url": "https://images.unsplash.com/photo-1541006008768-d181e7f9f3d9?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1568&q=80",
    "thumbnail_url": "https://images.unsplash.com/photo-1557804506-669a67965ba0?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=300&q=80"
  },
  {
    "id": 140,
    "name": "Azure",
    "sale_price": "null",
    "original_price": "782",
    "default_style": "0",
    "sid": 925,
    "size": "XS",
    "quantity": "21",
    "url": "https://images.unsplash.com/photo-1454024183771-42d54053cd75?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1650&q=80",
    "thumbnail_url": "https://images.unsplash.com/photo-1519862170344-6cd5e49cb996?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=300&q=80"
  },
  {
    "id": 140,
    "name": "Azure",
    "sale_price": "null",
    "original_price": "782",
    "default_style": "0",
    "sid": 925,
    "size": "XS",
    "quantity": "21",
    "url": "https://images.unsplash.com/photo-1544376664-80b17f09d399?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1525&q=80",
    "thumbnail_url": "https://images.unsplash.com/photo-1553830591-2f39e38a013c?ixlib=rb-1.2.1&auto=format&fit=crop&w=300&q=80"
  },
  {
    "id": 140,
    "name": "Azure",
    "sale_price": "null",
    "original_price": "782",
    "default_style": "0",
    "sid": 926,
    "size": "S",
    "quantity": "17",
    "url": "https://images.unsplash.com/photo-1525896650794-60ad4ec40d0e?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1650&q=80",
    "thumbnail_url": "https://images.unsplash.com/photo-1561861422-a549073e547a?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=300&q=80"
  },
  {
    "id": 140,
    "name": "Azure",
    "sale_price": "null",
    "original_price": "782",
    "default_style": "0",
    "sid": 926,
    "size": "S",
    "quantity": "17",
    "url": "https://images.unsplash.com/photo-1541006008768-d181e7f9f3d9?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1568&q=80",
    "thumbnail_url": "https://images.unsplash.com/photo-1557804506-669a67965ba0?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=300&q=80"
  },
  {
    "id": 140,
    "name": "Azure",
    "sale_price": "null",
    "original_price": "782",
    "default_style": "0",
    "sid": 926,
    "size": "S",
    "quantity": "17",
    "url": "https://images.unsplash.com/photo-1454024183771-42d54053cd75?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1650&q=80",
    "thumbnail_url": "https://images.unsplash.com/photo-1519862170344-6cd5e49cb996?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=300&q=80"
  },
  {
    "id": 140,
    "name": "Azure",
    "sale_price": "null",
    "original_price": "782",
    "default_style": "0",
    "sid": 926,
    "size": "S",
    "quantity": "17",
    "url": "https://images.unsplash.com/photo-1544376664-80b17f09d399?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1525&q=80",
    "thumbnail_url": "https://images.unsplash.com/photo-1553830591-2f39e38a013c?ixlib=rb-1.2.1&auto=format&fit=crop&w=300&q=80"
  },
  {
    "id": 140,
    "name": "Azure",
    "sale_price": "null",
    "original_price": "782",
    "default_style": "0",
    "sid": 927,
    "size": "M",
    "quantity": "9",
    "url": "https://images.unsplash.com/photo-1525896650794-60ad4ec40d0e?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1650&q=80",
    "thumbnail_url": "https://images.unsplash.com/photo-1561861422-a549073e547a?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=300&q=80"
  },
];

const addPhotos = (data, results) => {
  for (let i = 0; i < data.length; i++) {
    let current = data[i];
    let index = results.findIndex(elem => elem.style_id === current.id);
    results[index].photos.push({ url: current.url, thumbnail_url: current.thumbnail_url })
  }
}
const addSkus = (data, uniqSkus, results) => {
  let indexes = [];
  for ( let j = 0; j < uniqSkus.length; j++) {
    let sku = uniqSkus[j];
    const index = data.findIndex( elem => elem.sid === sku);
    indexes.push(index);
  }
  let skusObjs = [];
  for ( let k = 0; k < indexes.length; k++) {
    let index = indexes[k];
    skusObjs.push(data[index]);
  }
  skusObjs.forEach(obj=> {
    let index = results.findIndex(result => result.style_id === obj.id)
    results[index].skus[obj.sid] = {
        size: obj.size,
        quantity: obj.quantity
      };
  });
};

const getSkus = (data) => {
  const allSkus = data.map(elem => elem.sid);
  let uniqSkus = new Set([...allSkus]);
  uniqSkus = Array.from(uniqSkus);
  return uniqSkus;
};

const getStyles = (data) => {
  const allStyleIds = data.map(elem => elem.id);
  let uniqStyles = new Set([...allStyleIds]);
  uniqStyles = Array.from(uniqStyles); //now an array
  return uniqStyles;
};

const composeStyleData = (data) => {
  const uniqSkus = getSkus(data);
  const uniqStyles = getStyles(data);
  let results = [];

  uniqStyles.forEach( (id) => {
    results.push(data.find( obj => obj.id === id));
  });

  results = results.map( (obj) => {
    return {
      style_id: obj.id,
      name: obj.name,
      original_price: obj.original_price,
      sale_price: obj.sale_price === "null" ? "0" : obj.sale_price,
      'default?': !!obj.default_style,
      photos: [],
      skus: {}
    };
  });

  addPhotos(data, results);
  addSkus(data, uniqSkus, results);
  return results;
}

module.exports = { getSkus, getStyles, composeStyleData };